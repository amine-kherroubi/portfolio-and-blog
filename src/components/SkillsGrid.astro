---
interface Skill {
  category: string;
  items: string[];
}

interface Props {
  skills: Skill[];
}

const { skills } = Astro.props;
---

<section
  class="py-24 md:py-32 lg:py-48 px-8 md:px-16 lg:px-20 xl:px-32 border-t-2 border-black"
>
  <div class="max-w-screen-2xl mx-auto">
    <h2 class="text-4xl md:text-5xl font-bold mb-16 lg:mb-24 fade-in-up">
      Skills & Expertise
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8">
      {
        skills.map((skill, index) => (
          <div
            class="skill-category bg-white border-2 border-black p-6 lg:p-8 fade-in-up"
            style={`--stagger: ${index * 0.1}s`}
          >
            <h3 class="text-sm font-bold uppercase tracking-widest mb-6 pb-4 border-b-2 border-black">
              {skill.category}
            </h3>
            <ul class="space-y-3" role="list">
              {skill.items.map((item) => (
                <li class="skill-item text-lg flex items-center gap-3">
                  <span class="w-2 h-2 bg-black shrink-0" aria-hidden="true" />
                  <span>{item}</span>
                </li>
              ))}
            </ul>
          </div>
        ))
      }
    </div>

    <!-- Interactive Skills Visualization -->
    <div class="mt-16 lg:mt-24 fade-in-up">
      <div class="bg-white border-4 border-black p-8 lg:p-12">
        <h3 class="text-2xl font-bold mb-8">Technical Proficiency</h3>
        <div class="space-y-6">
          <div class="skill-bar-container">
            <div class="flex justify-between mb-3">
              <span class="font-bold text-sm uppercase tracking-wider"
                >Frontend Development</span
              >
              <span class="font-bold text-sm">95%</span>
            </div>
            <div class="h-4 bg-gray-200 border-2 border-black overflow-hidden">
              <div
                class="skill-bar h-full bg-black"
                data-width="95"
                style="width: 0%"
              >
              </div>
            </div>
          </div>

          <div class="skill-bar-container">
            <div class="flex justify-between mb-3">
              <span class="font-bold text-sm uppercase tracking-wider"
                >UI/UX Design</span
              >
              <span class="font-bold text-sm">90%</span>
            </div>
            <div class="h-4 bg-gray-200 border-2 border-black overflow-hidden">
              <div
                class="skill-bar h-full bg-black"
                data-width="90"
                style="width: 0%"
              >
              </div>
            </div>
          </div>

          <div class="skill-bar-container">
            <div class="flex justify-between mb-3">
              <span class="font-bold text-sm uppercase tracking-wider"
                >Backend Development</span
              >
              <span class="font-bold text-sm">85%</span>
            </div>
            <div class="h-4 bg-gray-200 border-2 border-black overflow-hidden">
              <div
                class="skill-bar h-full bg-black"
                data-width="85"
                style="width: 0%"
              >
              </div>
            </div>
          </div>

          <div class="skill-bar-container">
            <div class="flex justify-between mb-3">
              <span class="font-bold text-sm uppercase tracking-wider"
                >Machine Learning</span
              >
              <span class="font-bold text-sm">80%</span>
            </div>
            <div class="h-4 bg-gray-200 border-2 border-black overflow-hidden">
              <div
                class="skill-bar h-full bg-black"
                data-width="80"
                style="width: 0%"
              >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  function initSkillBars() {
    const skillBarObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const bars = entry.target.querySelectorAll(".skill-bar");
            bars.forEach((bar) => {
              const width = (bar as HTMLElement).dataset.width;
              setTimeout(() => {
                (bar as HTMLElement).style.width = `${width}%`;
              }, 100);
            });
            skillBarObserver.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.3 }
    );

    const container = document
      .querySelector(".skill-bar-container")
      ?.closest("div");
    if (container) {
      skillBarObserver.observe(container);
    }
  }

  // Initialize on load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initSkillBars);
  } else {
    initSkillBars();
  }

  // Reinitialize on page navigation
  document.addEventListener("astro:page-load", initSkillBars);
</script>

<style>
  .fade-in-up {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.6s ease-out forwards;
    animation-delay: var(--stagger, 0s);
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .skill-item {
    opacity: 0;
    animation: fadeInLeft 0.4s ease-out forwards;
    animation-delay: calc(var(--stagger, 0s) + 0.2s);
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-10px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .skill-bar {
    transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .skill-category:hover {
    transform: translateY(-4px);
    box-shadow: 4px 4px 0 rgba(0, 0, 0, 1);
  }

  @media (prefers-reduced-motion: reduce) {
    .fade-in-up,
    .skill-item {
      opacity: 1;
      transform: none;
      animation: none;
    }

    .skill-bar {
      transition: none;
    }

    .skill-category:hover {
      transform: none;
      box-shadow: none;
    }
  }

  @media (prefers-reduced-motion: no-preference) {
    .skill-category {
      transition: all 0.3s ease;
    }

    .skill-item:nth-child(1) {
      animation-delay: calc(var(--stagger, 0s) + 0.2s);
    }
    .skill-item:nth-child(2) {
      animation-delay: calc(var(--stagger, 0s) + 0.3s);
    }
    .skill-item:nth-child(3) {
      animation-delay: calc(var(--stagger, 0s) + 0.4s);
    }
    .skill-item:nth-child(4) {
      animation-delay: calc(var(--stagger, 0s) + 0.5s);
    }
    .skill-item:nth-child(5) {
      animation-delay: calc(var(--stagger, 0s) + 0.6s);
    }
    .skill-item:nth-child(6) {
      animation-delay: calc(var(--stagger, 0s) + 0.7s);
    }
  }
</style>
