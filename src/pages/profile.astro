---
/**
 * Profile Page - Desktop Only (Refactored)
 *
 * Now uses shared social utilities for consistent link handling.
 */

import BaseLayout from "../layouts/BaseLayout.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";
import CapabilitiesSection from "../components/CapabilitiesSection.astro";
import { SITE } from "../config/site";
import { PAGE_IDS } from "@/utils/constants";
import { experience, principles, capabilities } from "../data/profile";
import { getSocialLinks } from "@/utils/social";

const socialLinks = getSocialLinks();
---

<BaseLayout
  title="Profile — Mohamed El Amine Kherroubi"
  description="Designer and developer focused on creating thoughtful digital experiences"
>
  <Navigation currentPage={PAGE_IDS.PROFILE} />

  <main id="main-content" class="px-8 py-24">
    <div class="max-w-container mx-auto space-y-24">
      <section class="space-y-6">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
          Profile
        </p>
        <h1 class="text-5xl font-bold leading-[1.1] tracking-[-0.02em]">
          Mohamed El Amine Kherroubi
        </h1>
        <div class="grid gap-12 grid-cols-12">
          <div
            class="col-span-8 space-y-4 text-lg leading-relaxed text-black/70"
          >
            <p>
              I design and build calm, purposeful digital products. My work
              pairs clear visual systems with reliable engineering so people can
              read, act, and move on without friction.
            </p>
            <p>
              The output is quiet on purpose—focused typography, measured
              rhythm, and interfaces that stay out of the way. I value
              accessibility, meaningful defaults, and details you only notice
              when they are missing.
            </p>
          </div>
          <div
            class="col-span-4 space-y-4 text-sm font-bold uppercase tracking-[0.15em]"
          >
            <div class="border-t-2 border-black pt-4">
              <div class="text-black/60 mb-2">Role</div>
              <div class="text-base font-bold normal-case tracking-normal">
                Designer & Developer
              </div>
            </div>
            <div class="border-t-2 border-black pt-4">
              <div class="text-black/60 mb-2">Based in</div>
              <div class="text-base font-bold normal-case tracking-normal">
                Remote • CET
              </div>
            </div>
            <div class="border-t-2 border-black pt-4">
              <div class="text-black/60 mb-2">Availability</div>
              <div class="text-base font-bold normal-case tracking-normal">
                Select collaborations, 2025
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="space-y-6 border-t-2 border-black pt-16">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
          Approach
        </p>
        <div class="grid gap-8 grid-cols-2">
          {
            principles.map((principle) => (
              <div class="space-y-3">
                <h3 class="text-xl font-bold leading-[1.1] tracking-[-0.02em]">
                  {principle.title}
                </h3>
                <p class="text-base leading-relaxed text-black/70">
                  {principle.description}
                </p>
              </div>
            ))
          }
        </div>
      </section>

      <section class="space-y-6 border-t-2 border-black pt-16">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
          Experience
        </p>
        <div class="space-y-4">
          {
            experience.map((item) => (
              <div class="flex items-baseline justify-between border-b-2 border-black/10 pb-4">
                <div class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
                  {item.period}
                </div>
                <div class="text-right">
                  <div class="text-lg font-bold mb-1">{item.title}</div>
                  <div class="text-base text-black/70">{item.company}</div>
                </div>
              </div>
            ))
          }
        </div>
      </section>

      <section class="space-y-6 border-t-2 border-black pt-16">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
          Connect
        </p>
        <div class="grid gap-8 grid-cols-2">
          <div class="space-y-4">
            <h3 class="text-base font-bold uppercase tracking-[0.15em]">
              Email
            </h3>
            <a
              href={`mailto:${SITE.email}`}
              class="text-lg font-bold border-b-2 border-transparent hover:border-black transition-colors duration-200 focus-visible:border-black break-all inline-block"
            >
              {SITE.email}
            </a>
          </div>

          {
            socialLinks.length > 0 && (
              <div class="space-y-4">
                <h3 class="text-base font-bold uppercase tracking-[0.15em]">
                  Social
                </h3>
                <div class="space-y-3">
                  {socialLinks.map(({ href, label, platform }) => (
                    <a
                      href={href}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="block text-base hover:opacity-50 transition-opacity duration-200 focus-visible:opacity-50"
                      data-social-platform={platform}
                    >
                      {label}
                    </a>
                  ))}
                </div>
              </div>
            )
          }
        </div>
      </section>

      <section class="space-y-6 border-t-2 border-black pt-16">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-black/60">
          Contact
        </p>
        <div class="flex gap-6 items-center justify-between">
          <p class="text-lg text-black/70">
            Prefer projects that value clarity, performance, and thoughtful
            craft.
          </p>
          <a
            href={`mailto:${SITE.email}`}
            class="inline-flex items-center gap-2 border-2 border-black px-5 py-3 text-sm font-bold uppercase tracking-[0.15em] hover:bg-black hover:text-white transition-colors duration-200 focus-visible:bg-black focus-visible:text-white"
          >
            Email Me
          </a>
        </div>
      </section>
    </div>
  </main>

  <CapabilitiesSection capabilities={capabilities} />

  <Footer />
</BaseLayout>

<script>
  /**
   * Track social link clicks with analytics
   */
  import { trackSocialClick } from "@/utils/use-analytics";

  function initSocialTracking() {
    const socialLinks = document.querySelectorAll<HTMLAnchorElement>(
      "[data-social-platform]"
    );

    socialLinks.forEach((link) => {
      link.addEventListener("click", () => {
        const platform = link.dataset["socialPlatform"];
        if (platform) {
          trackSocialClick(platform, "profile_page");
        }
      });
    });
  }

  // Initialize on page load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initSocialTracking);
  } else {
    initSocialTracking();
  }

  // Reinitialize on Astro page navigation
  document.addEventListener("astro:page-load", initSocialTracking);
</script>
