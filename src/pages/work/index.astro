---
/**
 * Work Index Page
 * 
 * Lists all work projects with filtering capabilities.
 * Features:
 * - Tag-based filtering
 * - Responsive list layout
 */

import BaseLayout from "../../layouts/BaseLayout.astro";
import Navigation from "../../components/Navigation.astro";
import Footer from "../../components/Footer.astro";
import FilterBar from "../../components/FilterBar.astro";
import ProjectCard from "../../components/ProjectCard.astro";
import PageHeader from "../../components/PageHeader.astro";
import ContentList from "../../components/ContentList.astro";
import { getCollection } from "astro:content";
import { PAGE_IDS } from "../../utils/constants";
import {
  processWorkProjects,
  getUniqueTagsFromProjects,
} from "../../utils/content";

/**
 * Fetch and process all work projects
 */
const allWorkProjects = await getCollection("work");
const projects = processWorkProjects(allWorkProjects);
const allTags = getUniqueTagsFromProjects(projects);
---

<BaseLayout title="Work">
  <Navigation currentPage={PAGE_IDS.WORK} />

  <PageHeader
    title="Work"
    description="Selected projects demonstrating technical expertise and design thinking"
  />

  <FilterBar tags={allTags} type="work" />

  <ContentList>
    {
      projects.map((project, i) => (
        <div
          data-work-item
          data-work-tags={project.tags.join(",")}
          class:list={[i === projects.length - 1 && "border-b-0"]}
        >
          <ProjectCard
            title={project.title}
            description={project.description}
            year={project.year}
            tags={project.tags}
            link={project.link}
            variant="list"
          />
        </div>
      ))
    }
  </ContentList>

  <Footer />
</BaseLayout>